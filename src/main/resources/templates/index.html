<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movies - Browse Movies, TV Shows & More</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸŽ¬</text></svg>">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>

<body>

    <header>
        <div class="container">
            <div class="header-top">
                <div class="logo">
                    <a th:href="@{/}">MOVIES</a>
                </div>

                <div class="search-bar">
                    <form th:action="@{/browse}" method="get">
                        <input type="text" name="search" placeholder="Search movies...">
                    </form>
                </div>

                <div class="auth-controls">
                    <span th:if="${loggedInUser != null}">
                        <a th:href="@{/favorites}">My List</a>
                    </span>

                    <span th:if="${loggedInUser != null}" th:text="${loggedInUser.username}"
                        style="opacity: 0.7;"></span>
                    <a th:if="${loggedInUser != null}" th:href="@{/logout}">Sign Out</a>

                    <div th:if="${loggedInUser == null}" style="display: flex; gap: 15px;">
                        <a th:href="@{/register}" class="btn-secondary">Register</a>
                        <a th:href="@{/login}" class="btn-primary">Sign In</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container" style="margin-top: 50px;">

        <!-- Top Rated -->
        <div class="section-header">
            <h2>Top Rated</h2>
            <a th:href="@{/browse(type='top')}">View All â†’</a>
        </div>
        <section class="movie-list">
            <div class="movie-card" th:each="movie : ${topRated}" onclick="location.href=this.querySelector('a').href">
                <a th:href="@{/movie/{id}(id=${movie.id})}" style="display: none;"></a>
                <div class="poster-wrapper">
                    <img th:src="${movie.poster}" onerror="this.src='/images/placeholder.png'">
                </div>
                <div class="movie-info-visible">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <div class="movie-meta-row">
                        <span th:text="${movie.year}">2023</span>
                        <span><span class="rating-star">â˜…</span><span th:text="${movie.averageRating}">8.5</span></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Latest Releases -->
        <div class="section-header">
            <h2>Latest Releases</h2>
            <a th:href="@{/browse(type='latest')}">View All â†’</a>
        </div>
        <section class="movie-list">
            <div class="movie-card" th:each="movie : ${latest}" onclick="location.href=this.querySelector('a').href">
                <a th:href="@{/movie/{id}(id=${movie.id})}" style="display: none;"></a>
                <div class="poster-wrapper">
                    <img th:src="${movie.poster}" onerror="this.src='/images/placeholder.png'">
                </div>
                <div class="movie-info-visible">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <div class="movie-meta-row">
                        <span th:text="${movie.year}">2023</span>
                        <span><span class="rating-star">â˜…</span><span th:text="${movie.averageRating}">8.5</span></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Genres -->
        <div class="section-header">
            <h2>Browse by Genre</h2>
            <a th:href="@{/genres}">View All â†’</a>
        </div>
        <div class="genre-grid">
            <a th:each="genre, stat : ${genres}" th:if="${stat.count <= 6}" th:href="@{/browse(genre=${genre})}"
                class="genre-card">
                <span th:text="${genre}">Action</span>
            </a>
        </div>

        <!-- Favorites (If Logged In) -->
        <div th:if="${favorites != null && !favorites.isEmpty()}">
            <div class="section-header">
                <h2>Your List</h2>
                <a th:href="@{/favorites}">View All â†’</a>
            </div>
            <section class="movie-list">
                <div class="movie-card" th:each="movie : ${favorites}"
                    onclick="location.href=this.querySelector('a').href">
                    <a th:href="@{/movie/{id}(id=${movie.id})}" style="display: none;"></a>
                    <div class="poster-wrapper">
                        <img th:src="${movie.poster}" onerror="this.src='/images/placeholder.png'">
                    </div>
                    <div class="movie-info-visible">
                        <h3 th:text="${movie.title}">Movie Title</h3>
                        <div class="movie-meta-row">
                            <span th:text="${movie.year}">2023</span>
                            <span><span class="rating-star">â˜…</span><span
                                    th:text="${movie.averageRating}">8.5</span></span>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <footer>
        <p>&copy; 2024 Movies Inc. Powered by Spring Boot.</p>
    </footer>

</body>

</html>